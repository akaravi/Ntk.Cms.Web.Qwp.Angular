<div class="contact-us-container">
  <div class="page-header">
    <h1>تماس با ما</h1>
    <p class="subtitle">نظرات و پیشنهادات خود را با ما در میان بگذارید</p>
  </div>

  <div class="contact-content">
    <mat-card class="contact-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>contact_mail</mat-icon>
          فرم تماس با ما
        </mat-card-title>
      </mat-card-header>
      
      <mat-card-content>
        <form #contactForm="ngForm" (ngSubmit)="onFormSubmit()" class="contact-form">
          
          <!-- Info Alert -->
          <mat-card class="info-card" *ngIf="dataModelResultDepartemen && dataModelResultDepartemen.isSuccess">
            <mat-card-content>
              <div class="info-content">
                <mat-icon class="info-icon">info</mat-icon>
                <div>
                  <strong>در ساخت وب سایت دقت کنید</strong><br>
                  به صورت پیش فرض هر کاربر می‌تواند یک وب سایت داشته باشد ولی در چندین سایت کاربر باشد
                </div>
              </div>
            </mat-card-content>
          </mat-card>

          <!-- Department Selection -->
          <mat-form-field appearance="outline" *ngIf="dataModelResultDepartemen && dataModelResultDepartemen.isSuccess">
            <mat-label>دپارتمان</mat-label>
            <mat-select [(ngModel)]="dataModel.linkTicketingDepartemenId" name="linkTicketingDepartemenId">
              <mat-option *ngFor="let item of dataModelResultDepartemen.listItems; let i = index" 
                          [value]="item.id">
                {{item.title}}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Full Name -->
          <mat-form-field appearance="outline">
            <mat-label>نام و نام خانوادگی</mat-label>
            <input matInput [(ngModel)]="dataModel.fullName" name="FullName" type="text" required>
            <mat-icon matPrefix>person</mat-icon>
          </mat-form-field>

          <!-- Phone Number -->
          <mat-form-field appearance="outline">
            <mat-label>شماره تماس</mat-label>
            <input matInput [(ngModel)]="dataModel.phoneNo" name="PhoneNo" type="tel" class="phone-number" dir="ltr">
            <mat-icon matPrefix>phone</mat-icon>
          </mat-form-field>

          <!-- Email -->
          <mat-form-field appearance="outline">
            <mat-label>ایمیل</mat-label>
            <input matInput [(ngModel)]="dataModel.email" name="Email" type="email" class="email-text" dir="ltr">
            <mat-icon matPrefix>email</mat-icon>
          </mat-form-field>

          <!-- Message -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>پیام شما</mat-label>
            <textarea matInput [(ngModel)]="dataModel.htmlBody" name="Description" rows="5" required></textarea>
            <mat-icon matPrefix>message</mat-icon>
          </mat-form-field>

          <!-- Captcha -->
          <div class="captcha-section">
            <div class="captcha-image-wrapper">
              <img [src]="captchaModel.image" (click)="onCaptchaOrder()" class="captcha-image" alt="کپچا">
              <span class="captcha-hint">برای تغییر تصویر کلیک کنید</span>
            </div>
            <mat-form-field appearance="outline" class="captcha-input">
              <mat-label>متن تصویر امنیتی</mat-label>
              <input matInput [(ngModel)]="dataModel.captchaText" name="captchaText" 
                     #captchaTextGet="ngModel" autocomplete="off" required>
              <mat-error *ngIf="captchaTextGet.invalid && (captchaTextGet.dirty || captchaTextGet.touched)">
                <span *ngIf="captchaTextGet.errors?.required">پر کردن این فیلد الزامی است</span>
              </mat-error>
            </mat-form-field>
          </div>

          <!-- Loading Indicator -->
          <mat-progress-bar *ngIf="loadingStatus" mode="indeterminate"></mat-progress-bar>

          <!-- Form Messages -->
          <mat-card class="message-card message-success" *ngIf="formInfo.formAlert && dataModelResult?.isSuccess">
            <mat-card-content>
              {{formInfo.formAlert}}
            </mat-card-content>
          </mat-card>

          <mat-card class="message-card message-error" *ngIf="formInfo.formError">
            <mat-card-content>
              {{formInfo.formError}}
            </mat-card-content>
          </mat-card>

          <!-- Action Buttons -->
          <div class="form-actions">
            <button mat-raised-button color="primary" type="submit" 
                    [disabled]="loadingStatus || !contactForm.valid" class="submit-button">
              <mat-icon>send</mat-icon>
              ارسال
            </button>
            <button mat-stroked-button type="button" [routerLink]="'../'" class="cancel-button">
              <mat-icon>cancel</mat-icon>
              انصراف
            </button>
          </div>

        </form>
      </mat-card-content>
    </mat-card>
  </div>
</div>